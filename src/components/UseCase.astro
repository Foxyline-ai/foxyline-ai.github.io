---
import BeforeAfter from './BeforeAfter.astro';
import type { ImageMetadata } from 'astro';

interface Props {
  id: string;
  title: string;
  specialty: string;
  location: string;
  diagnostic?: string;
  description: string;
  beforeImage: string | ImageMetadata;
  afterImage: string | ImageMetadata;
  beforeLabel?: string;
  afterLabel?: string;
  websiteUrl?: string;
  ctaText?: string;
  results?: {
    label: string;
    value: string;
  }[];
  reverse?: boolean;
}

const { id, title, specialty, location, diagnostic, description, beforeImage, afterImage, beforeLabel = "Avant", afterLabel = "Apr√®s", websiteUrl, ctaText = "Voir le site", results, reverse = false } = Astro.props;
---

<div class={`grid lg:grid-cols-2 gap-8 lg:gap-12 items-center ${reverse ? 'lg:flex-row-reverse' : ''}`}>
  <!-- Content -->
  <div class={`space-y-6 ${reverse ? 'lg:order-2' : ''}`}>
    <div class="space-y-3">
      <div class="flex items-center gap-3 flex-wrap">
        <span
          class="text-xs uppercase tracking-widest px-3 py-1 rounded-full"
          style="background-color: var(--color-natural-beige); color: var(--color-forest); font-family: Outfit, sans-serif; font-weight: 500;"
        >
          {specialty}
        </span>
        <span
          class="text-xs"
          style="color: var(--color-deep-sage); font-family: Outfit, sans-serif; font-weight: 300;"
        >
          {location}
        </span>
      </div>

      <h3
        style="font-family: Outfit, sans-serif; font-size: clamp(24px, 4vw, 32px); line-height: 1.2; color: var(--color-forest); font-weight: 500;"
      >
        {title}
      </h3>
    </div>

    {diagnostic && (
      <div class="p-4 rounded-lg" style="background-color: var(--color-natural-beige);">
        <p
          class="text-sm italic"
          style="font-family: Outfit, sans-serif; line-height: 1.5; color: var(--color-deep-sage); font-weight: 300;"
        >
          {diagnostic}
        </p>
      </div>
    )}

    <div>
      <p
        class="text-xs uppercase tracking-wider mb-2"
        style="color: var(--color-copper); font-family: Outfit, sans-serif; font-weight: 500;"
      >
        Ce que nous avons fait
      </p>
      <p
        style="font-family: Outfit, sans-serif; font-size: 16px; line-height: 1.6; color: var(--color-deep-sage); font-weight: 300;"
      >
        {description}
      </p>
    </div>

    {websiteUrl && (
      <a
        href={websiteUrl}
        target="_blank"
        rel="noopener noreferrer"
        class="inline-flex items-center gap-2 px-5 py-2.5 rounded-lg transition-all hover:shadow-md hover:scale-105"
        style="background-color: var(--color-copper); color: white; font-family: Outfit, sans-serif; font-size: 14px; font-weight: 400; text-decoration: none;"
      >
        {ctaText}
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
          <polyline points="15 3 21 3 21 9"></polyline>
          <line x1="10" y1="14" x2="21" y2="3"></line>
        </svg>
      </a>
    )}

    <!-- Results Grid -->
    {results && results.length > 0 && (
      <div class="grid grid-cols-2 gap-4 pt-2">
        {results.map((result) => (
          <div class="space-y-1">
            <p
              class="text-xs uppercase tracking-wider"
              style="color: var(--color-deep-sage); font-family: Outfit, sans-serif; font-weight: 400; opacity: 0.7;"
            >
              {result.label}
            </p>
            <p
              style="font-family: Outfit, sans-serif; font-size: clamp(24px, 5vw, 32px); line-height: 1; color: var(--color-copper); font-weight: 500;"
            >
              {result.value}
            </p>
          </div>
        ))}
      </div>
    )}
  </div>

  <!-- Before/After Slider -->
  <div class={reverse ? 'lg:order-1' : ''}>
    <BeforeAfter
      id={id}
      beforeImage={beforeImage}
      afterImage={afterImage}
      beforeLabel={beforeLabel}
      afterLabel={afterLabel}
    />
  </div>
</div>
